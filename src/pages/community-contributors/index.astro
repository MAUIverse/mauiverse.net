---
import BaseLayout from '../../layouts/BaseLayout.astro';
import {
  getAuthorKeys,
  getAuthorDisplayName,
  getAuthorImageSrc,
} from '../../data/authors';

type Contributor = {
  githubUsername: string;
  displayName: string;
};

function shuffleContributors(contributors: Contributor[]): Contributor[] {
  const shuffled = [...contributors];
  for (let index = shuffled.length - 1; index > 0; index -= 1) {
    const randomIndex = Math.floor(Math.random() * (index + 1));
    [shuffled[index], shuffled[randomIndex]] = [shuffled[randomIndex], shuffled[index]];
  }
  return shuffled;
}

const contributors = shuffleContributors(
  getAuthorKeys().map((githubUsername) => ({
    githubUsername,
    displayName: getAuthorDisplayName(githubUsername),
  }))
);
---

<BaseLayout
  title="Community Contributors | MAUIverse"
  description="Discover the people contributing to the MAUIverse Community Feed."
  allowPageScroll={true}
>
  <section class="min-h-screen px-0 py-24">
    <div class="container mx-auto max-w-6xl px-4">
      <p class="mb-4 text-xl font-header font-bold uppercase text-brand">
        From the community
      </p>
      <h1 class="mb-4 text-4xl font-header font-bold uppercase text-brand-dark">
        Community Contributors
      </h1>
      <p class="mb-12 max-w-2xl text-base text-muted">
        Meet the people who share projects, tips, and package launches via across the MAUIverse Feed.
        </br>
        Contributions are curated by the community from accross the internet. Featuring here does not necessarily mean the individual is a MAUIverse member.
      </p>

      <ul class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4" aria-label="Community Contributors">
        {contributors.map((contributor) => (
          <li class="rounded-lg border border-edge bg-surface p-6 shadow-sm">
            <div class="flex h-full flex-col items-center text-center">
              <img
                src={getAuthorImageSrc(contributor.githubUsername, 256)}
                alt={`${contributor.displayName} profile picture`}
                width="96"
                height="96"
                class="mb-4 h-24 w-24 rounded-full"
                loading="lazy"
              />
              <h2 class="mb-4 text-lg font-semibold text-brand-dark">{contributor.displayName}</h2>
              <a
                href={`/community-contributors/${contributor.githubUsername}/`}
                class="mt-auto inline-flex w-full items-center justify-center rounded-full border border-edge bg-surface px-4 py-2 text-sm font-semibold text-muted transition hover:bg-surface-alt hover:text-brand"
              >
                View Contributor
              </a>
            </div>
          </li>
        ))}
      </ul>
    </div>
  </section>
</BaseLayout>
