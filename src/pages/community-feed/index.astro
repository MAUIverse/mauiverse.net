---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import FeedEntries from '../../components/community-feed/FeedEntries.astro';
import Pagination from '../../components/community-feed/Pagination.astro';
import CommunityFeedIntroPanel from '../../components/community-feed/CommunityFeedIntroPanel.astro';
import { paginateEntries } from '../../utils/pagination';

const entries = (await getCollection('community-feed')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

const pageSize = 15;
const { pages, totalPages } = paginateEntries(entries, pageSize);
const pageEntries = pages[0]?.entries ?? [];
---

<BaseLayout
  title="Community Feed | MAUIverse"
  description="Notable moments, packages, projects, and celebrations from the MAUIverse community."
  allowPageScroll={true}
>
  <section class="py-24 px-0 min-h-screen">
    <div class="container max-w-4xl mx-auto px-4">
      <CommunityFeedIntroPanel />

      <FeedEntries entries={pageEntries} />
      <Pagination currentPage={1} totalPages={totalPages} />
    </div>
  </section>
</BaseLayout>
