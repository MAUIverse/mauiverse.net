---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import FeedEntries from '../../components/community-feed/FeedEntries.astro';
import Pagination from '../../components/community-feed/Pagination.astro';

const entries = (await getCollection('community-feed')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

const pageSize = 15;
const totalPages = Math.max(1, Math.ceil(entries.length / pageSize));
const pageEntries = entries.slice(0, pageSize);
---

<BaseLayout
  title="Community Feed | MAUIverse"
  description="Notable moments, packages, projects, and celebrations from the MAUIverse community."
>
  <!-- This site's default global.css locks overflow to hidden for the fullscreen homepage -->
  <style is:global>
    html,
    body {
      height: auto;
      overflow: auto;
    }
  </style>

  <section class="bg-brand-light py-24 px-0 min-h-screen">
    <div class="container max-w-4xl mx-auto px-4">
      <p class="text-brand-extra font-bold mb-4 text-xl font-header uppercase">
        From the community
      </p>
      <h1 class="text-brand-dark text-4xl md:text-4xl uppercase font-header font-bold mb-4">
        Community Feed
      </h1>
      <p class="text-brand-dark text-base text-md mb-12 max-w-2xl">
        Notable moments, packages, projects, and celebrations from the MAUIverse community.
      </p>

      <div class="mb-8 rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
        <h2 class="mb-2 text-2xl font-header font-bold text-brand-dark">
          Community Contributors
        </h2>
        <p class="mb-4 text-gray-700">
          Discover everyone contributing to the Community Feed.
        </p>
        <a
          href="/community-contributors/"
          class="inline-flex items-center justify-center rounded-full border border-gray-300 bg-white px-4 py-2 text-sm font-semibold text-gray-700 transition hover:bg-gray-50"
        >
          Browse Community Contributors
        </a>
      </div>

      <FeedEntries entries={pageEntries} />
      <Pagination currentPage={1} totalPages={totalPages} />
    </div>
  </section>
</BaseLayout>
